"use strict";var app=angular.module("weddingApp",["ngMessages","ngMaterial","xeditable","ngCookies","ui.router","moment-picker","angularMoment","ngPatternRestrict","ngJsonExportExcel",angularDragula(angular)]).config(["$stateProvider","$urlRouterProvider","$locationProvider","momentPickerProvider",function(e,t,n,o){n.html5Mode({enabled:!0,requireBase:!1}),e.state("initialize",{url:"/",views:{mainView:{templateUrl:"/public/views/initialize.html",controller:"initializeController"}}}).state("main",{url:"/main",views:{headerView:{templateUrl:"/public/views/header.html",controller:"headerController"},mainView:{templateUrl:"/public/views/general.html",controller:"generalController"}}}).state("guestsList",{url:"/lista",views:{headerView:{templateUrl:"/public/views/header.html",controller:"headerController"},mainView:{templateUrl:"/public/views/guests_list.html",controller:"guestsListController"}}}).state("guestsArrangement",{url:"/rozmieszczenie",views:{headerView:{templateUrl:"/public/views/header.html",controller:"headerController"},mainView:{templateUrl:"/public/views/guests_arrangement.html",controller:"guestsArrangementController"}}}).state("budget",{url:"/budżet",views:{headerView:{templateUrl:"/public/views/header.html",controller:"headerController"},mainView:{templateUrl:"/public/views/budget.html",controller:"budgetController"}}}).state("calendar",{url:"/kalendarz",views:{headerView:{templateUrl:"/public/views/header.html",controller:"headerController"},mainView:{templateUrl:"/public/views/calendar.html",controller:"calendarController"}}}),t.otherwise("/"),o.options({locale:"pl",format:"L LTS",minView:"decade",maxView:"minute",startView:"year",autoclose:!0,today:!1,keyboard:!1,leftArrow:"&larr;",rightArrow:"&rarr;",yearsFormat:"YYYY",monthsFormat:"MMMM",daysFormat:"D",hoursFormat:"HH:[00]",minutesFormat:moment.localeData().longDateFormat("LT").replace(/[aA]/,""),secondsFormat:"ss",minutesStep:5,secondsStep:1})}]).run(["$state","amMoment","editableOptions","editableThemes",function(e,t,n,o){e.go("initialize"),t.changeLocale("pl")}]);angular.module("weddingApp").controller("budgetController",["$scope","$mdDialog","expenses",function(e,t,n){e.expenses=n,e.addExpense=function(){alert=t.alert({controller:"dialogController",templateUrl:"public/views/expenses_add_dialog.html",parent:angular.element(document.body),clickOutsideToClose:!0,escapeToClose:!0}),t.show(alert).finally(function(){alert=void 0})},e.editExpense=function(e){n.beforeEdit=angular.copy(e),n.toEdit=e,alert=t.alert({controller:"dialogController",templateUrl:"public/views/expenses_edit_dialog.html",parent:angular.element(document.body),clickOutsideToClose:!0,escapeToClose:!0}),t.show(alert).finally(function(){alert=void 0})},e.deleteExpense=function(e){n.toDelete=e,alert=t.alert({controller:"dialogController",templateUrl:"public/views/expenses_delete_dialog.html",parent:angular.element(document.body),clickOutsideToClose:!0,escapeToClose:!1}),t.show(alert).finally(function(){alert=void 0})},e.filterExpenses=function(e){return"opłacone"===e?function(e){return e.price===e.paid}:"częściowo"===e?function(e){return e.price!==e.paid&&0<e.paid}:void 0}}]),angular.module("weddingApp").controller("calendarController",["$scope","$mdDialog","actions",function(e,t,n){e.actions=n,e.addAction=function(){alert=t.alert({controller:"dialogController",templateUrl:"public/views/actions_add_dialog.html",parent:angular.element(document.body),clickOutsideToClose:!0,escapeToClose:!0}),t.show(alert).finally(function(){alert=void 0})},e.editAction=function(e){n.beforeEdit=angular.copy(e),n.toEdit=e,alert=t.alert({controller:"dialogController",templateUrl:"public/views/actions_edit_dialog.html",parent:angular.element(document.body),clickOutsideToClose:!0,escapeToClose:!0}),t.show(alert).finally(function(){alert=void 0})},e.deleteAction=function(e){n.toDelete=e,alert=t.alert({controller:"dialogController",templateUrl:"public/views/actions_delete_dialog.html",parent:angular.element(document.body),clickOutsideToClose:!0,escapeToClose:!0}),t.show(alert).finally(function(){alert=void 0})},e.filterActions=function(e){return"wykonane"===e?function(e){return!0===e.done}:"niewykonane"===e?function(e){return!1===e.done}:void 0}}]),angular.module("weddingApp").controller("dialogController",["$scope","$http","$mdDialog","$timeout","guestList","expenses","actions","moment",function(i,l,r,t,s,a,o,d){i.guestList=s,i.expenses=a,i.actions=o,i.dialogHide=function(){r.hide()},i.guestExist=function(){alert=r.alert({title:"Uwaga!",content:"Istnieje gość o podanej nazwie. Proszę wybrać inną nazwę.",ok:"Close"}),r.show(alert).finally(function(){alert=void 0})},i.expenseExist=function(){alert=r.alert({title:"Uwaga!",content:"Istnieje wydatek o podanej nazwie. Proszę wybrać inną nazwę.",ok:"Close"}),r.show(alert).finally(function(){alert=void 0})},i.actionExist=function(){alert=r.alert({title:"Uwaga!",content:"Istnieje czynność o podanej nazwie. Proszę wybrać inną nazwę.",ok:"Close"}),r.show(alert).finally(function(){alert=void 0})},i.confirmedDeleteGuest=function(){r.hide(),s.deleteGuest()},i.confirmedDeleteExpense=function(){r.hide(),a.deleteExpense()},i.confirmedDeleteAction=function(){r.hide(),o.deleteAction()},i.confirmAdd=function(n,e){var t={};for(var o in n.checkboxs)!1===n.checkboxs[o]?delete n.checkboxs[o]:t[o]=n.checkboxs[o];var a={name:n.name,checkboxs:[t]};e||r.hide(),l.post("/guests_add",a).then(function(e){"exist"===e.data?(i.guestExist(),Object.keys(n.checkboxs).forEach(function(e,t){return n.checkboxs[e]=!1}),n.name=""):(s.model.push(a),Object.keys(n.checkboxs).forEach(function(e,t){return n.checkboxs[e]=!1}),n.name="",s.get())})},i.addExpense=function(t){var n=!1;if(a.model.forEach(function(e){e.name===t.name&&(n=!0)}),n)i.expenseExist(),a.name="",a.price="";else{var o={name:t.name,price:t.price,paid:0};l.post("/expenses__add",o).then(function(e){r.hide(),a.expensesAmount=a.expensesAmount+o.price,a.model.push(e.data),a.diff=a.expensesAmount-a.expensesPaidAmount,t.name="",t.price="",a.get()})}},i.addAction=function(t){var n=!1,e=d(t.date,"YYYY dddd D MMMM HH:[00]").unix();t.utc=e,o.model.forEach(function(e){e.name===t.name&&(n=!0)}),n?i.actionExist():l.post("/actions_add",t).then(function(e){r.hide(),o.get()})},i.confirmEdit=function(e){var t=0;s.model.forEach(function(e){e.name===s.toEdit.name&&t++}),2===t?(r.hide(),i.guestExist(),s.get()):(e.partner||(e.partner=0),s.filteredGuests=s.filteredGuests+e.partner,s.guests=s.guests+e.partner,s.filters.forEach(function(e){s.filter(e)}),r.hide(),l.post("/guests_edit",e).then(function(e){}))},i.confirmEditExpenses=function(t){if(t.price!==a.beforeEdit.price||t.paid!==a.beforeEdit.paid){var e=t.price-a.beforeEdit.price;a.expensesAmount=a.expensesAmount+e;var n=t.paid-a.beforeEdit.paid;a.expensesPaidAmount=a.expensesPaidAmount+n,a.diff=a.expensesAmount-a.expensesPaidAmount}var o=0;a.model.forEach(function(e){e.name===t.name&&o++}),2===o?(r.hide(),i.expenseExist(),a.get()):(r.hide(),l.post("/expenses_edit",t).then(function(e){}))},i.confirmEditActions=function(t){var n=0;if(o.model.forEach(function(e){e.name===t.name&&n++}),2===n)r.hide(),i.actionExist(),o.get();else{r.hide();var e=d(t.date,"YYYY dddd D MMMM HH:[00]").unix();t.utc=e,l.post("/actions_edit",t).then(function(e){o.get()})}},i.checkChanges=function(){s.beforeEdit.name===s.toEdit.name&&JSON.stringify(s.beforeEdit.checkboxs[0])===JSON.stringify(s.toEdit.checkboxs[0])?i.guestChanged=!1:void 0===s.toEdit.name?i.guestChanged=!1:i.guestChanged=!0},i.checkExpenseChanges=function(){a.beforeEdit.name===a.toEdit.name&&a.beforeEdit.price===a.toEdit.price&&a.beforeEdit.paid===a.toEdit.paid?i.expenseChanged=!1:void 0===a.toEdit.name||void 0===a.toEdit.price||void 0===a.toEdit.paid?i.expenseChanged=!1:i.expenseChanged=!0},i.checkActionsChanges=function(){o.beforeEdit.name===o.toEdit.name&&o.beforeEdit.date===o.toEdit.date&&o.beforeEdit.type===o.toEdit.type&&o.beforeEdit.done===o.toEdit.done&&o.beforeEdit.note===o.toEdit.note?i.actionsChanged=!1:i.actionsChanged=!0},i.action={name:void 0,date:"Data Czynności",type:void 0},i.enableAddActionButton=!1,i.checkenableAddActionButton=function(e){void 0!==e.name&&"Data Czynności"!==e.date&&void 0!==e.type?t(function(){i.enableAddActionButton=!0},0):t(function(){i.enableAddActionButton=!1},0)},i.updateDateOfAction=function(e,t){i.action.date=e,void 0!==i.action.name&&void 0!==i.action.type&&(i.enableAddActionButton=!0)},i.updateEditingDateOfAction=function(e,t){o.toEdit.date=e,o.beforeEdit.name===o.toEdit.name&&o.beforeEdit.date===o.toEdit.date&&o.beforeEdit.type===o.toEdit.type?i.actionsChanged=!1:i.actionsChanged=!0},i.updateEditingDateOfActionGeneral=function(e,t){o.toEdit.date=e,o.beforeEditGeneral.name===o.toEditGeneral.name&&o.beforeEditGeneral.date===o.toEditGeneral.date&&o.beforeEditGeneral.type===o.toEditGeneral.type?i.actionsChangedGeneral=!1:i.actionsChangedGeneral=!0}}]),angular.module("weddingApp").controller("generalController",["$scope","$http","$timeout","$interval","moment",function(i,n,o,l,r){function a(n,o){i.dateOfWedding=n;var e=r(n,"YYYY dddd D MMMM HH:mm"),t=r(o,"YYYY-MM-DD HH:mm:ss");i.countdownTimer=r.duration(e.diff(t)).format("HH:mm:ss");var a=0;i.interval=l(function(){a++;var e=r(n,"YYYY dddd D MMMM HH:mm"),t=r(o,"YYYY-MM-DD HH:mm:ss").add(a,"seconds");i.countdownTimer=r.duration(e.diff(t)).format("HH:mm:ss")},1e3)}i.countdown=function(){n.get("/get_date_of_wedding").then(function(e){"dataNotSet"!==e.data?a(e.data.date[0].date,e.data.now):i.dateOfWedding="Wybierz datę ślubu"})},i.updateDateOfWedding=function(t,e){o(function(){n.post("/update_date_of_wedding",{date:t}).then(function(e){l.cancel(i.interval),a(t,e.data.now)})},0)},o(function(){i.countdown()},0),i.getMap=function(e,a){(new google.maps.Geocoder).geocode({address:e},function(e,t){if(t==google.maps.GeocoderStatus.OK){var n={zoom:16,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},center:e[0].geometry.location},o=new google.maps.Map(document.getElementById(a),n);new google.maps.Marker({map:o,position:e[0].geometry.location,draggable:!1,animation:google.maps.Animation.DROP})}else alert("Nie można znaleźć podanej nazwy. Spróbuj jeszcze raz."),"weddingVenue"===a?i.weddingVenue="Zła nazwa miejsca ślubu.":"weddingPartyVenue"===a&&(i.weddingPartyVenue="Zła nazwa miejsca wesela.")})},i.getWeddingVenue=function(){n.get("/get_wedding_venue").then(function(e){"New York City"===e.data.place.place?(i.weddingVenue="Miejsce Ślubu",i.getMap(e.data.place.place,"weddingVenue")):(i.weddingVenue=e.data.place[0].place,i.getMap(e.data.place[0].place,"weddingVenue"))})},i.updateWeddingVenue=function(e){n.post("/update_wedding_venue",{place:e}).then(function(e){o(function(){i.getMap(e.data.place.place,"weddingVenue")},0)})},i.getWeddingPartyVenue=function(){n.get("/get_wedding_party_venue").then(function(e){"Plac Św. Piotra"===e.data.place.place?(i.weddingPartyVenue="Miejsce Wesela",i.getMap(e.data.place.place,"weddingPartyVenue")):(i.weddingPartyVenue=e.data.place[0].place,i.getMap(e.data.place[0].place,"weddingPartyVenue"))})},i.updateWeddingPartyVenue=function(e){n.post("/update_wedding_party_venue",{place:e}).then(function(e){o(function(){i.getMap(e.data.place.place,"weddingPartyVenue")},0)})},i.getWeddingVenue(),i.getWeddingPartyVenue()}]),angular.module("weddingApp").controller("guestsArrangementController",["$scope","$http","$compile","$parse","$mdDialog","dragulaService","guestList",function(a,e,i,l,t,n,o){a.tables=[],a.guestList=o,a.getGuestList=function(){e.get("/guests_list").then(function(e){a.guestsOfTable=[];e.data.guests.forEach(function(e){if(0,"none"===e.table){if(a.guestsOfTable.push(e),e.checkboxs[0].partner){var t={name:e.name+" os.tow."};a.guestsOfTable.push(t)}}else if(a[e.table]){if(a[e.table].push(e),e.checkboxs[0].partner){t={name:e.name+" os.tow."};a[e.table].push(t)}}else if(a[e.table]=[],a.tables.push(e.table),a[e.table].push(e),e.checkboxs[0].partner){t={name:e.name+" os.tow."};a[e.table].push(t)}}),a.tables.forEach(function(e){var t='<div class="table__wrapper" layout="column" layout-align="center center">\n                        <p class="table__title">'+e+'</p>\n                        <div class="table__guests" dragula=\'"first-bag"\' dragula-model=\''+e+'\' layout="column" layout-align="center center">\n                          <p ng-repeat="item in '+e+'" class="table__guest" title="{{item.name}}"><span class="guests__index">{{$index+1}}</span>{{\'.   \' + item.name}}</p>\n                        </div>\n                      </div>',n=angular.element(document.getElementsByClassName("tables__container")[0]),o=i(t)(a);n.append(o)})})},a.getGuestList(),n.options(a,"first-bag",{revertOnSpill:!0}),a.tableExist=function(){alert=t.alert({title:"Uwaga!",content:"Istnieje stół o podanej nazwie. Proszę wybrać inną nazwę.",ok:"Close"}),t.show(alert).finally(function(){alert=void 0})},a.add=function(e){if(a.name="",a.tables.includes(e))a.tableExist();else{l(e).assign(a,[]);var t='<div class="table__wrapper" layout="column" layout-align="center center">\n                        <p class="table__title">'+e+'</p>\n                        <div class="table__guests" dragula=\'"first-bag"\' dragula-model=\''+e+'\' layout="column" layout-align="center center">\n                          <p ng-repeat="item in '+e+'" class="table__guest" title="{{item.name}}"><span class="guests__index">{{$index+1}}</span>{{\'.   \' + item.name}}</p>\n                        </div>\n                      </div>',n=angular.element(document.getElementsByClassName("tables__container")[0]),o=i(t)(a);n.append(o),a.tables.push(e)}},a.saveArrangement=function(){var n=[];a.guestsOfTable.forEach(function(e){e.table="none",n.push(e)}),a.tables.forEach(function(t){a[t].forEach(function(e){e.table=t,n.push(e)})}),e.post("/arrangement__update",n).then(function(e){})}}]),angular.module("weddingApp").controller("guestsListController",["$scope","$mdDialog","guestList",function(e,t,n){e.guestList=n,e.addGuest=function(){alert=t.alert({controller:"dialogController",templateUrl:"public/views/guests_add_dialog.html",parent:angular.element(document.body),clickOutsideToClose:!0,escapeToClose:!0}),t.show(alert).finally(function(){alert=void 0})},e.editGuest=function(e){n.beforeEdit=angular.copy(e),n.toEdit=e,alert=t.alert({controller:"dialogController",templateUrl:"public/views/guests_edit_dialog.html",parent:angular.element(document.body),clickOutsideToClose:!0,escapeToClose:!0}),t.show(alert).finally(function(){alert=void 0})},e.deleteGuest=function(e){n.toDelete=e,alert=t.alert({controller:"dialogController",templateUrl:"public/views/guests_delete_dialog.html",parent:angular.element(document.body),clickOutsideToClose:!0,escapeToClose:!1}),t.show(alert).finally(function(){alert=void 0})}}]),angular.module("weddingApp").controller("headerController",["$scope","$state","$cookies","$location","$mdSidenav",function(n,e,t,o,a){var i;n.toggleLeft=(i="left",function(){a(i).toggle()}),n.changeViewToMain=function(){e.go("main")},n.changeViewToGuestsList=function(){e.go("guestsList")},n.changeViewToGuestsArrangement=function(){e.go("guestsArrangement")},n.changeViewToBudget=function(){e.go("budget")},n.changeViewToCalendar=function(){e.go("calendar")},n.logout=function(){t.remove("auth"),e.go("initialize")};var l="header--route",r=o.url();n.views__route=[l,l,l,l,l],n.changeClass=function(e){var t=["/main","/lista","/rozmieszczenie","/bud%C5%BCet","/kalendarz"].indexOf(e);n.views__route[t]="header--route header--route-active"},n.changeClass(r)}]),angular.module("weddingApp").controller("initializeController",["$scope","$http","login","signUp",function(e,t,n,o){e.login=n,e.signUp=o}]),angular.module("weddingApp").factory("actions",["$http",function(e){var o={get:function(){e.get("/actions_list").then(function(e){o.model=e.data,o.modelChurch=[],o.modelGeneral=[],o.modelBride=[],o.modelGroom=[],o.earliest=o.model.sort(function(e,t){return parseFloat(e.utc)-parseFloat(t.utc)}),o.earliest=o.earliest.filter(function(e){return 0!==e.utc}),o.model.forEach(function(e,t){e.nested=[],e.index=t+1,"Kościół"===e.type?o.modelChurch.push(e):"Ogólne"===e.type?o.modelGeneral.push(e):"Panna Młoda"===e.type?o.modelBride.push(e):"Pan Młody"===e.type&&o.modelGroom.push(e)});var t,n=0;for(o.earliestModel=[],t=0;t<o.earliest.length&&5!==n;t++)n++,o.earliestModel.push(o.earliest[t])})}};return o.get(),o.deleteAction=function(){e.post("/actions_delete",o.toDelete).then(function(e){o.get()})},o}]),angular.module("weddingApp").factory("expenses",["$http",function(e){var t={get:function(){e.get("/expenses_list").then(function(e){t.model=e.data,t.model.forEach(function(e,t){e.nested=[],e.index=t+1}),t.expensesAmount=0,t.expensesPaidAmount=0,t.model.forEach(function(e){t.expensesAmount=t.expensesAmount+parseInt(e.price),t.expensesPaidAmount=t.expensesPaidAmount+parseInt(e.paid)}),t.diff=t.expensesAmount-t.expensesPaidAmount})},deleteExpense:function(){e.post("/expenses_delete",t.toDelete).then(function(e){t.get()})}};return t.get(),t}]),angular.module("weddingApp").factory("guestList",["$http",function(e){var n={get:function(t){e.get("/guests_list").then(function(e){n.model=e.data.guests,n.guests=n.model.length,n.modelCopy=angular.copy(n.model),n.model.forEach(function(e,t){e.nested=[],e.index=t+1,e.checkboxs[0].partner&&n.guests++}),n.filteredGuests=n.guests,t&&n.filters.forEach(function(e){n.filter(e)})})}};return n.get(),n.getCheckbox=function(e,t){switch(e){case"women":return"Kobieta";case"men":return"Mężczyzna";case"partner":return"Z Os. Tow.";case"noPartner":return"Bez Os. Tow.";case"invite":return"Zaproszono";case"noInvite":return"Nie Zapr.";case"confirmation":return"Potwierdzono";case"noConfirmation":return"Nie Potw.";case"accommodation":return"Nocleg";case"noAccommodation":return"Brak Noclegu";case"groom":return"Pan Młody";case"bride":return"Pani Młoda"}},n.filtersSex=[{sex:"None"},{sex:"Kobieta"},{sex:"Mężczyzna"}],n.filtersCompan=[{compan:"None"},{compan:"Tak"},{compan:"Nie"}],n.filtersInvited=[{invited:"None"},{invited:"Tak"},{invited:"Nie"}],n.filtersConfirmed=[{confirmed:"None"},{confirmed:"Tak"},{confirmed:"Nie"}],n.filtersAccommodation=[{accommodation:"None"},{accommodation:"Tak"},{accommodation:"Nie"}],n.filtersFamily=[{family:"None"},{family:"Pani Młoda"},{family:"Pan Młody"}],n.filters=[],n.filterBySex=function(t){t={sex:t.sex},0!==n.filters.filter(function(e){return void 0!==e.sex}).length?n.filters.forEach(function(e){void 0!==e.sex&&(e.sex=t.sex)}):n.filters.push(t)},n.filterByCompan=function(t){t={compan:t.compan},0!==n.filters.filter(function(e){return void 0!==e.compan}).length?n.filters.forEach(function(e){void 0!==e.compan&&(e.compan=t.compan)}):n.filters.push(t)},n.filterByInvited=function(t){t={invited:t.invited},0!==n.filters.filter(function(e){return void 0!==e.invited}).length?n.filters.forEach(function(e){void 0!==e.invited&&(e.invited=t.invited)}):n.filters.push(t)},n.filterByConfirmed=function(t){t={confirmed:t.confirmed},0!==n.filters.filter(function(e){return void 0!==e.confirmed}).length?n.filters.forEach(function(e){void 0!==e.confirmed&&(e.confirmed=t.confirmed)}):n.filters.push(t)},n.filterByAccommodation=function(t){t={accommodation:t.accommodation},0!==n.filters.filter(function(e){return void 0!==e.accommodation}).length?n.filters.forEach(function(e){void 0!==e.accommodation&&(e.accommodation=t.accommodation)}):n.filters.push(t)},n.filterByFamily=function(t){t={family:t.family},0!==n.filters.filter(function(e){return void 0!==e.family}).length?n.filters.forEach(function(e){void 0!==e.family&&(e.family=t.family)}):n.filters.push(t)},n.filter=function(e){void 0!==e.sex?"None"===e.sex?n.filterBySex(e):"Kobieta"===e.sex?n.filterBySex(e):"Mężczyzna"===e.sex&&n.filterBySex(e):void 0!==e.compan?"None"===e.compan?n.filterByCompan(e):"Tak"===e.compan?n.filterByCompan(e):"Nie"===e.compan&&n.filterByCompan(e):void 0!==e.invited?"None"===e.invited?n.filterByInvited(e):"Tak"===e.invited?n.filterByInvited(e):"Nie"===e.invited&&n.filterByInvited(e):void 0!==e.confirmed?"None"===e.confirmed?n.filterByConfirmed(e):"Tak"===e.confirmed?n.filterByConfirmed(e):"Nie"===e.confirmed&&n.filterByConfirmed(e):void 0!==e.accommodation?"None"===e.accommodation?n.filterByAccommodation(e):"Tak"===e.accommodation?n.filterByAccommodation(e):"Nie"===e.accommodation&&n.filterByAccommodation(e):void 0!==e.family&&("None"===e.family?n.filterByFamily(e):"Pani Młoda"===e.family?n.filterByFamily(e):"Pan Młody"===e.family&&n.filterByFamily(e)),n.filterBy=[],n.filters.forEach(function(e){if(void 0!==e.sex)switch(e.sex){case"Kobieta":n.filterBy.push("women");break;case"Mężczyzna":n.filterBy.push("men");break;case"None":n.filterBy.push("none")}else if(void 0!==e.compan)switch(e.compan){case"Tak":n.filterBy.push("partner");break;case"Nie":n.filterBy.push("noPartner");break;case"None":n.filterBy.push("none")}else if(void 0!==e.invited)switch(e.invited){case"Tak":n.filterBy.push("invite");break;case"Nie":n.filterBy.push("noInvite");break;case"None":n.filterBy.push("none")}else if(void 0!==e.confirmed)switch(e.confirmed){case"Tak":n.filterBy.push("confirmation");break;case"Nie":n.filterBy.push("noConfirmation");break;case"None":n.filterBy.push("none")}else if(void 0!==e.accommodation)switch(e.accommodation){case"Tak":n.filterBy.push("accommodation");break;case"Nie":n.filterBy.push("noAccommodation");break;case"None":n.filterBy.push("none")}else if(void 0!==e.family)switch(e.family){case"Pani Młoda":n.filterBy.push("bride");break;case"Pan Młody":n.filterBy.push("groom");break;case"None":n.filterBy.push("none")}}),n.model=n.modelCopy.filter(function(t){if(n.filterBy.filter(function(e){return!0===t.checkboxs[0][e]}).length===n.filterBy.length)return t});var t=0;n.model.forEach(function(e){e.checkboxs[0].partner&&t++}),n.filteredGuests=n.model.length+t},n.deleteGuest=function(){e.post("/guests_delete",n.toDelete).then(function(e){n.model=n.model.filter(function(e){return e._id!==n.toDelete._id}),n.toDelete.checkboxs[0].partner?(n.filteredGuests=n.filteredGuests-2,n.guests=n.guests-2):(n.filteredGuests=n.filteredGuests-1,n.guests=n.guests-1)})},n}]),angular.module("weddingApp").factory("login",["$http","$window","$cookies","$mdDialog","$state",function(t,e,n,o,a){var i={account:{}};return i.account.email="",i.account.password="",i.currentNavItem="login",i.showLogin=!0,i.userDoesntConfirmed=function(){alert=o.alert({title:"Uwaga!",content:"Konto nie zostało aktywowane. Proszę potwierdzić link rejestracyjny wysłany na maila.",ok:"Close"}),o.show(alert).finally(function(){alert=void 0})},i.userDoesntExist=function(){alert=o.alert({title:"Uwaga!",content:"Konto nie istnieje. Proszę wpisać dane jeszcze raz.",ok:"Close"}),o.show(alert).finally(function(){alert=void 0})},i.do=function(e){t.post("/login",e).then(function(e){"confirmed"===e.data.account?(n.remove("auth"),n.put("auth",e.data.token),a.go("main")):"confirmEmail"===e.data.account?i.userDoesntConfirmed():i.userDoesntExist(),i.account.email="",i.account.password=""})},i.demo=function(){t.post("/login",{email:"demo@email.com",password:"demo123"}).then(function(e){"confirmed"===e.data.account?(n.remove("auth"),n.put("auth",e.data.token),a.go("main")):"confirmEmail"===e.data.account?i.userDoesntConfirmed():i.userDoesntExist(),i.account.email="",i.account.password=""})},i.changeNav=function(e){"signUp"===e&&i.showLogin?i.showLogin=!1:"login"!==e||i.showLogin||(i.showLogin=!0)},i}]),angular.module("weddingApp").factory("signUp",["$http","$mdDialog",function(t,e){var n={account:{}};return n.account.email="",n.account.password="",n.emailUsed=function(){alert=e.alert({title:"Uwaga!",content:"Podany email jest już wykorzystywany, proszę podać inny.",ok:"Close"}),e.show(alert).finally(function(){alert=void 0})},n.do=function(e){t.post("/signUp",e).then(function(e){void 0!==e.data.errmsg&&(n.emailUsed(),n.account.email="",n.account.password=""),n.account.email="",n.account.password=""})},n}]);